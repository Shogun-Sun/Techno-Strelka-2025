<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Карта</title>
    <link rel="stylesheet" href="./css/out.css">
    <script src="https://api-maps.yandex.ru/2.1/?apikey=cfb17578-6c78-4dbc-9099-c50949c99d19&lang=ru_RU" type="text/javascript"></script>
</head>

<body class=" antialiased selection:bg-pink-500 selection:text-white relative overflow-x-hidden"> 
    <div id="chatArea" class="w-full sm:w-140 h-screen pt-19 z-200 absolute top-0 right-0 flex items-center gap-2 bg-white duration-500 transition-transform ease-in-out translate-x-full">
        <button id="openChat" class="px-5 py-3 bg-black text-white rounded-full text-xl font-Halvar absolute -left-15
        border-2 border-white transition-all duration-500 shadow-lg shadow-white">
            <
        </button>
        <iframe class="w-full h-full rounded-5xl bg-white" id="inlineFrameExample" title="Inline Frame Example" src="http://localhost:3000/chatbot"></iframe>
    </div>


    <!-- Toast Notification Container -->
    <div id="toastContainer" class="fixed top-20 right-4 z-1000 space-y-3 w-80"></div>
    
    <nav class="fixed top-0 w-full py-4 bg-black flex flex-row justify-between px-2 sm:px-4 z-250 items-center">
        <div id="logo" class="border-white border">
            <img src="./pictures/t2_Logo_White_CMYK.png" alt="t2" class="w-8 sm:w-13 h-auto">
        </div>

        <div class="flex bg-gray-300 rounded-lg overflow-hidden shadow-md relative px-0 sm:px-3 py-0 sm:py-1 gap-0 sm:gap-2 md:gap-4 lg:gap-8" id="navContainer">
            <!-- Покрытие -->
            <div class="relative z-20 nav-item">
                <input type="radio" name="navSwitch" id="coverage" class="hidden" checked>
                <label for="coverage" class="nav-label">
                    Покрытие
                </label>
            </div>
            
            <!-- Отзывы -->
            <div class="relative z-20 nav-item">
                <input type="radio" name="navSwitch" id="reviews" class="hidden">
                <label for="reviews" class="nav-label">
                    Отзывы
                </label>
            </div>
            
            <!-- Офисы -->
            <div class="relative z-20 nav-item">
                <input type="radio" name="navSwitch" id="offices" class="hidden">
                <label for="offices" class="nav-label">
                    Офисы
                </label>
            </div>
            
            <!-- Индикатор выбора -->
            <div id="navIndicator" class="absolute h-full px-0.5 py-1 rounded-lg top-0 left-0 z-10 transition-all duration-500"> 
                <div class="w-full h-full bg-pink-600 rounded-lg shadow-sm"></div>               
            </div>
        </div>

        <button id="login" onclick="window.location.href = '/loginPage';" class="text-base font-Halvar text-black bg-white rounded-lg px-1 py-0.5 sm:px-3 sm:py-1
         hover:bg-gray-100">
            Войти
        </button>
    </nav>
    <div class="w-screen h-screen pt-18 sm:pt-19">
        <div id="map" class="w-full h-full"></div>
    </div>
    <div class ="fixed bottom-8 right-8 z-10 flex flex-col gap-4">
        <button id="addReviewBtn" class=" bg-black text-white px-3 py-2 lg:px-6 lg:py-2 rounded-xl shadow-lg hover:bg-gray-950 transition-colors 
        duration-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 font-Halvar">
            + Добавить отзыв
        </button>
    </div>

    <div id="filt_cover" class="fixed left-8 bottom-10 bg-white rounded-2xl px-4 py-6 lg:flex flex-col gap-4 w-90 hidden ">
        <div class="text-black font-Halvar text-xl text-left">Карта покрытий</div>
        <div>
            <input type="checkbox" class="checkbox_2g accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_2g" checked>
            <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10 bg-[rgb(203,181,209)]" for="checkbox_2g">2G</label>
            <p class="font-Rooftop text-base text-black">Телефонная связь, интернет для новостей и социальных сетей</p>
        </div>
        <div>
            <input type="checkbox" class="checkbox_3g accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_3g" checked>
            <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10  bg-[rgb(247,195,228)]" for="checkbox_3g">3G</label>
            <p class="font-Rooftop text-base text-black">Разговоры и интернет без ограничений, музыка и видео</p>
        </div>
        <div>
            <input type="checkbox" class="checkbox_4g accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_4g" checked>
            <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10  bg-[rgb(249,217,194)]" for="checkbox_4g">4G</label>
            <p class="font-Rooftop text-base text-black">Очень быстрый интернет, видео в высоком качестве</p>
        </div>
        <div>
            <input type="checkbox" class="checkbox_lte450 accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_lte450" checked>
            <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10 bg-[rgb(246,241,218)]" for="checkbox_ltee450">LTE450</label>
            <p class="font-Rooftop text-base text-black">Высокоскоростной интернет для самых удаленных районов (требуется оборудование Skylink)</p>
        </div>
    </div>
    
    <button id="openModal2" class="fixed left-4 bottom-6 bg-black text-white p-3 rounded-xl shadow-lg lg:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    <div id="FiltModal" class="fixed inset-0 z-10 hidden items-center justify-center bg-white/1 backdrop-blur-sm overflow-y-scroll ">
        <div class="bg-white rounded-2xl p-8 w-full max-w-md mx-4 flex flex-col gap-4 absolute top-20 mb-10">
            <div class="flex justify-between items-center py-1">
                <div class="text-black font-Halvar text-xl text-left">Карта покрытий</div>
                <button id="closeModal2" class="p-0">
                    <svg class="w-8 h-10 px-0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path class="stroke-2 stroke-gray-500" d="M7.75732 7.75745L16.2426 16.2427" ></path>
                        <path class="stroke-2 stroke-gray-500" d="M16.2426 7.75745L7.75732 16.2427" ></path>
                    </svg>
                </button>
            </div>
            <div class=" bg-white rounded-2xl px-4 py-6 lg:flex flex-col gap-4 w-90">
                <div>
                    <input type="checkbox" class="checkbox_2g_modal accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_2g" checked>
                    <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10 bg-[rgb(203,181,209)]" for="checkbox_2g">2G</label>
                    <p class="font-Rooftop text-base text-black">Телефонная связь, интернет для новостей и социальных сетей</p>
                </div>
                <div>
                    <input type="checkbox" class="checkbox_3g_modal accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_3g" checked>
                    <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10  bg-[rgb(247,195,228)]" for="checkbox_3g">3G</label>
                    <p class="font-Rooftop text-base text-black">Разговоры и интернет без ограничений, музыка и видео</p>
                </div>
                <div>
                    <input type="checkbox" class="checkbox_4g_modal accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_4g" checked>
                    <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10  bg-[rgb(249,217,194)]" for="checkbox_4g">4G</label>
                    <p class="font-Rooftop text-base text-black">Очень быстрый интернет, видео в высоком качестве</p>
                </div>
                <div>
                    <input type="checkbox" class="checkbox_lte450_modal accent-black text-white font-semibold font-Halvar w-4 h-4" id="checkbox_lte450" checked>
                    <label class="ml-2 font-Rooftop font-bold text-lg text-black px-4 py-0.5 rounded-10 bg-[rgb(246,241,218)]" for="checkbox_ltee450">LTE450</label>
                    <p class="font-Rooftop text-base text-black">Высокоскоростной интернет для самых удаленных районов (требуется оборудование Skylink)</p>
                </div>
            </div>
        </div>
    </div>

    

    <div id="reviewModal" class="fixed inset-0 z-10 hidden items-center justify-center bg-white/1 backdrop-blur-sm overflow-y-scroll ">
        <div class="bg-white rounded-2xl p-8 w-full max-w-md mx-4 flex flex-col gap-4 absolute top-20 mb-10">

            <div class="flex items-center justify-between py-1">                 
                <div class="text-2xl font-Halvar text-gray-950">Оставить отзыв</div>
                <button id="closeModal" class="p-0">
                    <svg class="w-8 h-10 px-0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path class="stroke-2 stroke-gray-500" d="M7.75732 7.75745L16.2426 16.2427" ></path>
                        <path class="stroke-2 stroke-gray-500" d="M16.2426 7.75745L7.75732 16.2427" ></path>
                    </svg>
                </button>
            </div>


            <div class="mb-6">
                <label class="text-lg block text-gray-500 mb-2 font-Rooftop">Ваш телефон</label>
                <div id="phoneNumberComment" class="flex flex-row gap-3 items-center text-3xl font-bold text-gray-950 text-center">
                </div>
            </div>
            
            <!-- Поле для отзыва -->
            <div class="mb-6">
                <label for="reviewText" class="text-lg block text-gray-500 mb-2 font-Rooftop">Ваш отзыв</label>
                <textarea id="reviewText" class="resize-none w-full h-50 px-4 py-3 border rounded-xl
                 focus:ring-2 focus:ring-gray-500 text-lg text-gray-950 p-2 font-semibold font-Rooftop
                 focus:border-transparent" placeholder="Напишите ваш отзыв здесь..." autosi></textarea>
            </div>

            <button id="startTest" class="w-full flex items-center justify-center text-xl font-semibold bg-black text-white py-3 rounded-xl hover:bg-gray-950 
            transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 font-Halvar">
                Пройти тест скорости
            </button>

            <div id="results" class="hidden space-y-3 text-left">
                <div class="flex justify-between">
                        <span class="font-semibold font-Rooftop">Скачивание:</span>
                        <div class="flex justify-between basis-1/2 ">
                            <span id="download-speed" class="font-bold font-Rooftop"></span>
                            <span> Mbps </span> 
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold font-Rooftop">Отправка:</span>
                        <div class="flex justify-between basis-1/2 ">
                            <span id="upload-speed" class="font-bold font-Rooftop"></span>
                            <span> Mbps </span> 
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold font-Rooftop">Пинг:</span>
                        <div class="flex justify-between basis-1/2">
                            <span id="ping" class="font-bold font-Rooftop"></span>
                            <span> ms </span> 
                        </div>
                    </div>
            </div>
            
            <!-- Кнопка отправки -->
            <button id="submitReview" class="w-full flex items-center justify-center text-xl font-semibold bg-black text-white py-3 rounded-xl hover:bg-gray-950 
            transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 font-Halvar">
                Отправить отзыв
            </button>
        </div>
    </div>

    <script id="balloonContent_template" type="text/x-handlebars-template">
        <div class="py-2 px-1 overflow-y-scroll h-auto flex flex-col gap-4 max-w-75 w-fit">
            <p class="text-lg font-Halvar text-black  block">Телефон: {{user.user_telephone}}</p>

            <p class="text-sm font-Rooftop text-black block w-full text-justify text-pretty whitespace-normal break-all hyphens-auto">{{review_text}}</p>
            
            {{#if review_speed_test.download}}
                <div id="results" class="space-y-3 text-left">
                    <div class="flex justify-between">
                        <span class="font-semibold font-Halvar">Скачивание:</span>
                        <div class="flex justify-between basis-1/2">
                            <span id="download-speed" class="font-bold font-Rooftop">{{review_speed_test.download}}</span>
                            <span> Mbps </span> 
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold font-Halvar">Отправка:</span>
                        <div class="flex justify-between basis-1/2 ">
                            <span id="upload-speed" class="font-bold font-Rooftop">{{review_speed_test.upload}}</span>
                            <span> Mbps </span> 
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold font-Halvar">Пинг:</span>
                        <div class="flex justify-between basis-1/2">
                            <span id="ping" class="font-bold font-Rooftop">{{review_speed_test.ping}}</span>
                            <span> ms </span> 
                        </div>
                    </div>
                </div>
            {{else}}
                <div class="text-black font-Rooftop text-sm">Данные о скорости интернета отстутствуют.</div>
            {{/if}}
        </div>
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
    <script src="./js/toggleButton.js"></script>
    <script src="./js/toasts.js" type="module"></script>
    <script src="/js/map.js" type="module"></script>
    <script>
        const checkbox_2g = document.querySelector(".checkbox_2g")
        const checkbox_2g_modal = document.querySelector(".checkbox_2g_modal")
        const checkbox_3g = document.querySelector(".checkbox_3g")
        const checkbox_3g_modal = document.querySelector(".checkbox_3g_modal")
        const checkbox_4g = document.querySelector(".checkbox_4g")
        const checkbox_4g_modal = document.querySelector(".checkbox_4g_modal")
        const checkbox_lte450 = document.querySelector(".checkbox_lte450")
        const checkbox_lte450_modal = document.querySelector(".checkbox_lte450_modal")

        
        //связь модального окна с кнопками на большом экране

        checkbox_2g.addEventListener('change', function() {
            checkbox_2g_modal.checked = this.checked;
        });

        checkbox_2g_modal.addEventListener('change', function() {
            checkbox_2g.checked = this.checked;
        });

        checkbox_3g.addEventListener('change', function() {
            checkbox_3g_modal.checked = this.checked;
        });

        checkbox_3g_modal.addEventListener('change', function() {
            checkbox_3g.checked = this.checked;
        });

        checkbox_4g.addEventListener('change', function() {
            checkbox_4g_modal.checked = this.checked;
        });

        checkbox_4g_modal.addEventListener('change', function() {
            checkbox_4g.checked = this.checked;
        });

        checkbox_lte450.addEventListener('change', function() {
            checkbox_lte450_modal.checked = this.checked;
        });

        checkbox_lte450_modal.addEventListener('change', function() {
            checkbox_lte450.checked = this.checked;
        });



        
        const op_but = document.getElementById('openModal2');
        const filt_mod = document.getElementById('FiltModal');
        const close_but = document.getElementById('closeModal2');
        op_but.addEventListener('click',()=>{
            filt_mod.classList.remove('hidden');
            filt_mod.classList.add('flex');
        })
        close_but.addEventListener('click', ()=>{
            closeModal();
        })
        document.addEventListener('resize', ()=>{
            if(document.documentElement.clientWidth < 1024) {
            document.getElementById('filt_cover').classList.add('hidden')
            }
        })
        op_but.addEventListener('click', () => {
            filt_mod.classList.remove('hidden');
        setTimeout(() => {
            filt_mod.classList.remove('opacity-0');
            filt_mod.classList.add('flex');    
            filt_mod.classList.add('opacity-100');
        }, 10);
    });

    const closeModal = () => {
        filt_mod.classList.remove('opacity-100');
        filt_mod.classList.add('opacity-0');
        filt_mod.classList.remove('flex');   
        setTimeout(() => {
        filt_mod.classList.add('hidden');
        }, 10);
    };

    close_but.addEventListener('click', closeModal);
    </script>
</body>
</html>