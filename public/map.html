<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Карта</title>
    <link rel="stylesheet" href="./css/out.css">
    <script src="https://api-maps.yandex.ru/2.1/?apikey=cfb17578-6c78-4dbc-9099-c50949c99d19&lang=ru_RU" type="text/javascript"></script>
</head>



<body class="font-sans antialiased">
    <div class="hidden right-3"></div>
    <nav class="fixed top-0 w-full py-4 bg-black flex flex-row justify-between px-4 z-50 items-center">
        <div id="logo">
            <img src="./pictures/t2_Logo_White_CMYK.png" alt="t2" class="w-10 h-auto">
        </div>
        <div class="flex bg-gray-200 rounded-lg overflow-hidden shadow-md relative px-3 py-1 gap-8">
            <!-- Покрытие -->
            <div class="relative z-20">
                <input type="radio" name="navSwitch" id="coverage" class="hidden" checked>
                <label for="coverage" class="w-28 text-center block text-lg text-black cursor-pointer px-4 py-1 transition-colors duration-200">
                    Покрытие
                </label>
            </div>
            
            <!-- Отзывы -->
            <div class="relative z-20">
                <input type="radio" name="navSwitch" id="reviews" class="hidden">
                <label for="reviews" class="w-28 text-center block text-lg text-black cursor-pointer px-4 py-1 transition-colors duration-200">
                    Отзывы
                </label>
            </div>
            
            <!-- Индикатор выбора -->
            <div id="navIndicator" class="absolute h-full py-1 w-28 rounded-lg top-0 left-3 z-10 transition-all duration-500"> 
                <div class="w-full h-full bg-white rounded-lg shadow-sm"></div>               
            </div>
        </div>
        <button id="login" onclick="window.location.href = '/loginPage';" class="text-base font-bold text-black bg-white rounded-lg px-3 py-1 hover:bg-gray-100">
            Войти
        </button>
    </nav>
    
    <div id="map" class="w-full h-screen"></div>
    
    <button id="addReviewBtn" class="fixed bottom-8 right-8 z-50 bg-gray-900 text-white px-6 py-3 rounded-xl shadow-lg hover:bg-gray-800 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50">
        + Добавить отзыв
    </button>

    <div id="reviewModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-white/1 backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-8 w-full max-w-md relative mx-4">
            <button id="closeModal" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 text-2xl">
                &times;
            </button>
            
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Оставить отзыв</h2>
            
            <div class="mb-6">
                <label class="block text-gray-700 mb-2">Ваш телефон</label>
                <div id="phoneNumberComment" class="flex flex-row gap-3 items-center text-3xl font-bold text-gray-950">
                   +7 000 000 00 00
                </div>
            </div>
            
            <!-- Поле для отзыва -->
            <div class="mb-6">
                <label for="reviewText" class="block text-gray-700 mb-2">Ваш отзыв</label>
                <textarea id="reviewText" rows="4" class="w-full h-fit max-h-70 min-h-10 px-4 py-3 border rounded-xl
                 focus:ring-2 focus:ring-gray-500 text-lg text-gray-950 p-2 font-semibold
                 focus:border-transparent" placeholder="Напишите ваш отзыв здесь..." autosi></textarea>
            </div>

            <button id="startTest" class="mb-6 w-full flex items-center justify-center text-xl font-semibold bg-gray-950 text-white py-3 rounded-xl hover:bg-gray-800 
            transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50">
                Пройти тест скорости
            </button>

            <div id="results" class="hidden space-y-3 text-left">
                <div class="flex justify-between">
                    <span class="font-medium">Скачивание:</span>
                    <span id="download-speed" class="font-bold"></span> Mbps
                </div>
                <div class="flex justify-between">
                    <span class="font-medium">Отправка:</span>
                    <span id="upload-speed" class="font-bold"></span> Mbps
                </div>
                <div class="flex justify-between">
                    <span class="font-medium">Пинг:</span>
                    <span id="ping" class="font-bold"></span> ms
                </div>
            </div>
            
            <!-- Кнопка отправки -->
            <button id="submitReview" class="w-full flex items-center justify-center text-xl font-semibold bg-gray-950 text-white py-3 rounded-xl hover:bg-gray-800 
            transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50">
                Отправить отзыв
            </button>
        </div>
    </div>

    <script id="balloonContent_template" type="text/x-handlebars-template">
        <div class="p-2 overflow-y-scroll h-auto ">
            <h3 class="font-bold mb-1">Отзыв</h3>
            <p class="mb-2">{{review_text}}</p>
            <p class="text-sm text-gray-600">Телефон: {{user.user_telephone}}</p>
            
            {{#if review_speed_test.download}}
                <div id="results" class=" space-y-3 text-left">
                    <div class="flex justify-between">
                        <span class="font-medium">Скачивание:</span>
                        <span id="download-speed" class="font-bold">{{review_speed_test.download}}</span> Mbps
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium">Отправка:</span>
                        <span id="upload-speed" class="font-bold">{{review_speed_test.upload}}</span> Mbps
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium">Пинг:</span>
                        <span id="ping" class="font-bold">{{review_speed_test.ping}}</span> ms
                    </div>
                </div>
            {{else}}
                <div>Данные о скорости интернета отстутствуют.</div>
            {{/if}}
        </div>
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
    <script src="./js/toggleButton.js"></script>
    <script src="./js/map.js"></script>
</body>
</html>